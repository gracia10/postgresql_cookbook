/* Statement 1.
EMP 테이블의 상위 테이블이 될 DEPT 테이블 생성*/
CREATE TABLE dept (
    deptno integer,
    dname  varchar(14),
    loc    varchar(13),
    CONSTRAINT pk_dept PRIMARY KEY (deptno)
);


/* Statement 2.
DEPT 테이블에 대한 외래 키 참조가 있는 EMP 테이블 생성.
외래 키를 사용하려면 EMP 테이블의 DEPTNO가 DEPT 테이블의 DEPTNO 열에 있어야 합니다.*/

CREATE TABLE emp (
    empno    integer,
    ename    varchar(10),
    job      varchar(9),
    mgr      integer,
    hiredate date,
    sal      integer,
    comm     integer,
    deptno   integer,
    CONSTRAINT pk_emp PRIMARY KEY (empno),
    CONSTRAINT fk_deptno FOREIGN KEY (deptno) REFERENCES dept (deptno)
);


/* Statement 3. DEPT 테이블에 행을 삽입 */
INSERT INTO DEPT (DEPTNO, DNAME, LOC)
VALUES (10, 'ACCOUNTING', 'NEW YORK');

INSERT INTO DEPT
VALUES (20, 'RESEARCH', 'DALLAS');

INSERT INTO DEPT
VALUES (30, 'SALES', 'CHICAGO');

INSERT INTO DEPT
VALUES (40, 'OPERATIONS', 'BOSTON');

/* Statement 4.
TO_DATE 함수를 사용하여 EMP 행 삽입 */

INSERT INTO emp
VALUES (7839, 'KING', 'PRESIDENT', NULL,
        TO_DATE('17-11-1981', 'dd-mm-yyyy'),
        5000, NULL, 10);

INSERT INTO emp
VALUES (7698, 'BLAKE', 'MANAGER', 7839,
        TO_DATE('1-5-1981', 'dd-mm-yyyy'),
        2850, NULL, 30);


INSERT INTO emp
VALUES (7782, 'CLARK', 'MANAGER', 7839,
        TO_DATE('9-6-1981', 'dd-mm-yyyy'),
        2450, NULL, 10);

INSERT INTO emp
VALUES (7566, 'JONES', 'MANAGER', 7839,
        TO_DATE('2-4-1981', 'dd-mm-yyyy'),
        2975, NULL, 20);


INSERT INTO emp
VALUES (7788, 'SCOTT', 'ANALYST', 7566,
        '1987-07-13'::date - INTERVAL '85 days',
        3000, NULL, 20);

INSERT INTO emp
VALUES (7902, 'FORD', 'ANALYST', 7566,
        TO_DATE('3-12-1981', 'dd-mm-yyyy'),
        3000, NULL, 20);


INSERT INTO emp
VALUES (7369, 'SMITH', 'CLERK', 7902,
        TO_DATE('17-12-1980', 'dd-mm-yyyy'),
        800, NULL, 20);

INSERT INTO emp
VALUES (7499, 'ALLEN', 'SALESMAN', 7698,
        TO_DATE('20-2-1981', 'dd-mm-yyyy'),
        1600, 300, 30);

INSERT INTO emp
VALUES (7521, 'WARD', 'SALESMAN', 7698,
        TO_DATE('22-2-1981', 'dd-mm-yyyy'),
        1250, 500, 30);

INSERT INTO emp
VALUES (7654, 'MARTIN', 'SALESMAN', 7698,
        TO_DATE('28-9-1981', 'dd-mm-yyyy'),
        1250, 1400, 30);

INSERT INTO emp
VALUES (7844, 'TURNER', 'SALESMAN', 7698,
        TO_DATE('8-9-1981', 'dd-mm-yyyy'),
        1500, 0, 30);

INSERT INTO emp
VALUES (7876, 'ADAMS', 'CLERK', 7788,
        '1987-07-13'::date - INTERVAL '51 days',
        1100, NULL, 20);

INSERT INTO emp
VALUES (7900, 'JAMES', 'CLERK', 7698,
        TO_DATE('3-12-1981', 'dd-mm-yyyy'),
        950, NULL, 30);

INSERT INTO emp
VALUES (7934, 'MILLER', 'CLERK', 7782,
        TO_DATE('23-1-1982', 'dd-mm-yyyy'),
        1300, NULL, 10);

/* Statement 5.
DEPT 테이블 DEPTNO의 기본 키와 EMP 테이블의 DEPTNO 외래 키를 기반으로 하는 DEPT와 EMP 테이블 간의 단순 조인 구문으로 입력된 값 확인 */

SELECT ename, dname, job, empno, hiredate, loc
FROM emp,
     dept
WHERE emp.deptno = dept.deptno
ORDER BY ename;

/* 아래와 같은 값이 조회됨
ENAME	DNAME	JOB	EMPNO	HIREDATE	LOC
ADAMS	RESEARCH	CLERK	7876	23-MAY-87	DALLAS
ALLEN	SALES	SALESMAN	7499	20-FEB-81	CHICAGO
BLAKE	SALES	MANAGER	7698	01-MAY-81	CHICAGO
CLARK	ACCOUNTING	MANAGER	7782	09-JUN-81	NEW YORK
FORD	RESEARCH	ANALYST	7902	03-DEC-81	DALLAS
JAMES	SALES	CLERK	7900	03-DEC-81	CHICAGO
JONES	RESEARCH	MANAGER	7566	02-APR-81	DALLAS
KING	ACCOUNTING	PRESIDENT	7839	17-NOV-81	NEW YORK
MARTIN	SALES	SALESMAN	7654	28-SEP-81	CHICAGO
MILLER	ACCOUNTING	CLERK	7934	23-JAN-82	NEW YORK
SCOTT	RESEARCH	ANALYST	7788	19-APR-87	DALLAS
SMITH	RESEARCH	CLERK	7369	17-DEC-80	DALLAS
TURNER	SALES	SALESMAN	7844	08-SEP-81	CHICAGO
WARD	SALES	SALESMAN	7521	22-FEB-81	CHICAGO
*/

/* Statement 6.
SQL 문의 GROUP BY 절은 그룹화되지 않은 열의 집계 함수를 허용합니다.
조인은 내부 조인이므로 직원이 없는 부서는 표시되지 않습니다. */

SELECT dname, COUNT(*) count_of_employees
FROM dept,
     emp
WHERE dept.deptno = emp.deptno
GROUP BY DNAME
ORDER BY 2 DESC;

/* 그 외 테이블 생성 */

CREATE TABLE T1 (
    ID INTEGER
);

INSERT INTO T1
VALUES (1);

CREATE TABLE T10 (
    ID INTEGER
);

INSERT INTO T10
VALUES (1);
INSERT INTO T10
VALUES (2);
INSERT INTO T10
VALUES (3);
INSERT INTO T10
VALUES (4);
INSERT INTO T10
VALUES (5);
INSERT INTO T10
VALUES (6);
INSERT INTO T10
VALUES (7);
INSERT INTO T10
VALUES (8);
INSERT INTO T10
VALUES (9);
INSERT INTO T10
VALUES (10);


CREATE TABLE T100 (
    ID INTEGER
);

INSERT INTO t100
VALUES (1);
INSERT INTO t100
VALUES (2);
INSERT INTO t100
VALUES (3);
INSERT INTO t100
VALUES (4);
INSERT INTO t100
VALUES (5);
INSERT INTO t100
VALUES (6);
INSERT INTO t100
VALUES (7);
INSERT INTO t100
VALUES (8);
INSERT INTO t100
VALUES (9);
INSERT INTO t100
VALUES (10);
INSERT INTO t100
VALUES (11);
INSERT INTO t100
VALUES (12);
INSERT INTO t100
VALUES (13);
INSERT INTO t100
VALUES (14);
INSERT INTO t100
VALUES (15);
INSERT INTO t100
VALUES (16);
INSERT INTO t100
VALUES (17);
INSERT INTO t100
VALUES (18);
INSERT INTO t100
VALUES (19);
INSERT INTO t100
VALUES (20);
INSERT INTO t100
VALUES (21);
INSERT INTO t100
VALUES (22);
INSERT INTO t100
VALUES (23);
INSERT INTO t100
VALUES (24);
INSERT INTO t100
VALUES (25);
INSERT INTO t100
VALUES (26);
INSERT INTO t100
VALUES (27);
INSERT INTO t100
VALUES (28);
INSERT INTO t100
VALUES (29);
INSERT INTO t100
VALUES (30);
INSERT INTO t100
VALUES (31);
INSERT INTO t100
VALUES (32);
INSERT INTO t100
VALUES (33);
INSERT INTO t100
VALUES (34);
INSERT INTO t100
VALUES (35);
INSERT INTO t100
VALUES (36);
INSERT INTO t100
VALUES (37);
INSERT INTO t100
VALUES (38);
INSERT INTO t100
VALUES (39);
INSERT INTO t100
VALUES (40);
INSERT INTO t100
VALUES (41);
INSERT INTO t100
VALUES (42);
INSERT INTO t100
VALUES (43);
INSERT INTO t100
VALUES (44);
INSERT INTO t100
VALUES (45);
INSERT INTO t100
VALUES (46);
INSERT INTO t100
VALUES (47);
INSERT INTO t100
VALUES (48);
INSERT INTO t100
VALUES (49);
INSERT INTO t100
VALUES (50);
INSERT INTO t100
VALUES (51);
INSERT INTO t100
VALUES (52);
INSERT INTO t100
VALUES (53);
INSERT INTO t100
VALUES (54);
INSERT INTO t100
VALUES (55);
INSERT INTO t100
VALUES (56);
INSERT INTO t100
VALUES (57);
INSERT INTO t100
VALUES (58);
INSERT INTO t100
VALUES (59);
INSERT INTO t100
VALUES (60);
INSERT INTO t100
VALUES (61);
INSERT INTO t100
VALUES (62);
INSERT INTO t100
VALUES (63);
INSERT INTO t100
VALUES (64);
INSERT INTO t100
VALUES (65);
INSERT INTO t100
VALUES (66);
INSERT INTO t100
VALUES (67);
INSERT INTO t100
VALUES (68);
INSERT INTO t100
VALUES (69);
INSERT INTO t100
VALUES (70);
INSERT INTO t100
VALUES (71);
INSERT INTO t100
VALUES (72);
INSERT INTO t100
VALUES (73);
INSERT INTO t100
VALUES (74);
INSERT INTO t100
VALUES (75);
INSERT INTO t100
VALUES (76);
INSERT INTO t100
VALUES (77);
INSERT INTO t100
VALUES (78);
INSERT INTO t100
VALUES (79);
INSERT INTO t100
VALUES (80);
INSERT INTO t100
VALUES (81);
INSERT INTO t100
VALUES (82);
INSERT INTO t100
VALUES (83);
INSERT INTO t100
VALUES (84);
INSERT INTO t100
VALUES (85);
INSERT INTO t100
VALUES (86);
INSERT INTO t100
VALUES (87);
INSERT INTO t100
VALUES (88);
INSERT INTO t100
VALUES (89);
INSERT INTO t100
VALUES (90);
INSERT INTO t100
VALUES (91);
INSERT INTO t100
VALUES (92);
INSERT INTO t100
VALUES (93);
INSERT INTO t100
VALUES (94);
INSERT INTO t100
VALUES (95);
INSERT INTO t100
VALUES (96);
INSERT INTO t100
VALUES (97);
INSERT INTO t100
VALUES (98);
INSERT INTO t100
VALUES (99);
INSERT INTO t100
VALUES (100);